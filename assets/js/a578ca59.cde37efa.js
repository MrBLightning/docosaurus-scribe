"use strict";(self.webpackChunkscribe=self.webpackChunkscribe||[]).push([[1982],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return f}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),l=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(t),f=o,h=d["".concat(c,".").concat(f)]||d[f]||p[f]||a;return t?r.createElement(h,i(i({ref:n},u),{},{components:t})):r.createElement(h,i({ref:n},u))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=d;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},4495:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},assets:function(){return u},toc:function(){return p},default:function(){return f}});var r=t(7462),o=t(3366),a=(t(7294),t(3905)),i=["components"],s={sidebar_position:3},c="Checking the SBOM for CVEs",l={unversionedId:"check_cves",id:"check_cves",title:"Checking the SBOM for CVEs",description:"In order to scan the resulting SBOM for CVEs you can use Grype. Grype is an open-source tool that can provide static CVE analysis on your SBOM. Grype does not require an internet connection to work \u2013 it uses a list of known CVEs that is included with the tool when you first download it. In an integrated environment (connected to the internet), Grype checks on each run if there are new CVEs to add to its DB. To avoid this check you can add a .grype.yaml configuration file where updating the DB is marked as false:",source:"@site/docs/check_cves.md",sourceDirName:".",slug:"/check_cves",permalink:"/docosaurus-scribe/docs/check_cves",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/check_cves.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"verify Command",permalink:"/docosaurus-scribe/docs/cli-tool/verify-command"},next:{title:"FAQ",permalink:"/docosaurus-scribe/docs/faq"}},u={},p=[],d={toc:p};function f(e){var n=e.components,s=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},d,s,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"checking-the-sbom-for-cves"},"Checking the SBOM for CVEs"),(0,a.kt)("p",null,"In order to scan the resulting SBOM for CVEs you can use ",(0,a.kt)("a",{href:"https://github.com/anchore/grype"},"Grype"),". Grype is an open-source tool that can provide static CVE analysis on your SBOM. Grype does not require an internet connection to work \u2013 it uses a list of known CVEs that is included with the tool when you first download it. In an integrated environment (connected to the internet), Grype checks on each run if there are new CVEs to add to its DB. To avoid this check you can add a .grype.yaml configuration file where updating the DB is marked as false:   "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"db:\n  auto-update: false\n")),(0,a.kt)("p",null,"It\u2019s recommended that you periodically download the latest version of Grype or allow it to update the CVE DB to make sure you have the latest CVE listing.\nAfter you have downloaded the binary you can scan the SBOM using this command:",(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("inlineCode",{parentName:"p"},"grype sbom:./image-sbom.json"),"   "),(0,a.kt)("p",null,"Here\u2019s an example for the Grype scan of Alpine \u2013 no vulnerabilities found.\n",(0,a.kt)("img",{loading:"lazy",alt:"Grype alpine",src:t(9628).Z,width:"1801",height:"203"}),"  "),(0,a.kt)("p",null,"Here\u2019s an example for the Grype scan of Couchbase \u2013 some vulnerabilities found.\n",(0,a.kt)("img",{loading:"lazy",alt:"Grype couchbase",src:t(2017).Z,width:"1804",height:"305"}),"  "),(0,a.kt)("p",null,"To get more exact information, it\u2019s recommended to use the flag -o (format) with the option \u2018json\u2019 like this:",(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("inlineCode",{parentName:"p"},"grype sbom:./image-sbom.json -o json")),(0,a.kt)("p",null,"The result would be listed in stdout and look like this:",(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("img",{loading:"lazy",alt:"Couchbase CVEs",src:t(6746).Z,width:"1825",height:"1053"}),"\netc'..."),(0,a.kt)("p",null,"Since the result of Grype is fully directed to stdout you can grab the result into a file using this cli format:",(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("inlineCode",{parentName:"p"},"grype sbom:./image-sbom.json -o json > report.json")," "),(0,a.kt)("p",null,"The resulting json file will contain the full report of the CVE\u2019s found in this SBOM."),(0,a.kt)("p",null,"The json CVE format looks like this:   "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'{\n  "vulnerability": {\n    ...\n  },\n  "relatedVulnerabilities": [\n    ...\n  ],\n  "matchDetails": [\n    ...\n  ],\n  "artifact": {\n    ...\n  }\n}\n')),(0,a.kt)("p",null,"And here\u2019s an example of a single vulnerability from Couchbase\u2019s result json:   "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'{\n   "vulnerability": {\n    "id": "CVE-2021-22570",\n    "dataSource": "https://nvd.nist.gov/vuln/detail/CVE-2021-22570",\n    "namespace": "nvd",\n    "severity": "High",\n    "urls": [\n     "https://github.com/protocolbuffers/protobuf/releases/tag/v3.15.0",\n     "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IFX6KPNOFHYD6L4XES5PCM3QNSKZBOTQ/",\n     "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3DVUZPALAQ34TQP6KFNLM4IZS6B32XSA/"\n    ],\n    "description": "Nullptr dereference when a null char is present in a proto symbol. The symbol is parsed incorrectly, leading to an unchecked call into the proto file\'s name during generation of the resulting error message. Since the symbol is incorrectly parsed, the file is nullptr. We recommend upgrading to version 3.15.0 or greater.",\n    "cvss": [\n     {\n      "version": "2.0",\n      "vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",\n      "metrics": {\n       "baseScore": 5,\n       "exploitabilityScore": 10,\n       "impactScore": 2.9\n      },\n      "vendorMetadata": {}\n     },\n     {\n      "version": "3.1",\n      "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",\n      "metrics": {\n       "baseScore": 7.5,\n       "exploitabilityScore": 3.9,\n       "impactScore": 3.6\n      },\n      "vendorMetadata": {}\n     }\n    ],\n    "fix": {\n     "versions": [],\n     "state": "unknown"\n    },\n    "advisories": []\n   },\n   "relatedVulnerabilities": [],\n   "matchDetails": [\n    {\n     "type": "cpe-match",\n     "matcher": "stock-matcher",\n     "searchedBy": {\n      "namespace": "nvd",\n      "cpes": [\n       "cpe:2.3:a:google:protobuf:v1.21.0:*:*:*:*:*:*:*"\n      ]\n     },\n     "found": {\n      "versionConstraint": "< 3.15.0 (unknown)",\n      "cpes": [\n       "cpe:2.3:a:google:protobuf:*:*:*:*:*:*:*:*"\n      ]\n     }\n    }\n   ],\n   "artifact": {\n    "name": "google.golang.org/protobuf",\n    "version": "v1.21.0",\n    "type": "go-module",\n    "locations": [],\n    "language": "",\n    "licenses": [],\n    "cpes": [\n     "cpe:2.3:a:google:protobuf:v1.21.0:*:*:*:*:*:*:*"\n    ],\n    "purl": "pkg:golang/google.golang.org/protobuf@v1.21.0",\n    "upstreams": []\n   }\n  },\n')))}f.isMDXComponent=!0},6746:function(e,n,t){n.Z=t.p+"assets/images/couchbase_cve-d6b65d685d0f33f0a118c6c08a9dccae.png"},9628:function(e,n,t){n.Z=t.p+"assets/images/grype_alpine-f2e104ce7a11ba73ffbf5fb4a7a4f7e3.png"},2017:function(e,n,t){n.Z=t.p+"assets/images/grype_couchbase-f38a9c5dd6967d888e980fdaae43b413.png"}}]);